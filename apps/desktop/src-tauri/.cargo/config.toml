# Cargo 构建配置 - 优化编译速度
# 文档: https://doc.rust-lang.org/cargo/reference/config.html

# ============================================
# Linux x86_64 - 使用 mold 链接器（仅本地开发）
# ============================================
# [target.x86_64-unknown-linux-gnu]
# linker = "clang"
# rustflags = ["-C", "link-arg=-fuse-ld=mold"]

# ============================================
# Linux ARM64 - 使用默认链接器（CI 兼容）
# ============================================
# [target.aarch64-unknown-linux-gnu]
# linker = "clang"
# rustflags = ["-C", "link-arg=-fuse-ld=mold"]

# ============================================
# macOS x86_64 - 使用系统链接器（已经很快）
# ============================================
[target.x86_64-apple-darwin]
# macOS 默认链接器性能良好，无需替换

# ============================================
# macOS ARM64 (Apple Silicon) - 使用系统链接器
# ============================================
[target.aarch64-apple-darwin]
# macOS 默认链接器性能良好，无需替换

# ============================================
# Windows MSVC - 使用 lld-link
# ============================================
[target.x86_64-pc-windows-msvc]
linker = "lld-link"

# ============================================
# 构建配置
# ============================================
[build]
# 并行编译任务数（默认为 CPU 核心数）
# jobs = 8

# sccache 和增量编译不兼容，开发时优先使用增量编译
# 如需使用 sccache（CI/全量构建），取消下行注释并设置 CARGO_INCREMENTAL=0
# rustc-wrapper = "sccache"

# ============================================
# 环境变量
# ============================================
[env]
# 启用增量编译（开发时更快）
CARGO_INCREMENTAL = "1"
