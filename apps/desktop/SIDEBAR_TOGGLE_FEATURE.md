# 可隐藏书库侧边栏功能

## 🎯 功能说明

书库侧边栏现在可以隐藏和显示，为写作提供更大的空间。

### 为什么需要这个功能？

当你进入一本书籍开始写作后，切换书籍的频率很低，此时书库侧边栏会占用宝贵的屏幕空间。通过隐藏侧边栏，你可以获得更宽敞的写作区域，专注于创作。

## ✨ 功能特性

### 1. 灵活切换
- 点击 ActivityBar 顶部的切换按钮
- 使用快捷键 `Ctrl+B` (Mac: `Cmd+B`)
- 侧边栏会平滑地滑入/滑出

### 2. 记住偏好
- 你的选择会自动保存到本地
- 下次打开应用时保持上次的状态
- 默认状态：关闭（给你更多空间）

### 3. 视觉反馈
- 切换按钮图标会根据状态变化
  - 📖 显示状态：`PanelLeftClose` 图标
  - 📕 隐藏状态：`PanelLeftOpen` 图标
- 鼠标悬停显示提示文字

## 🎮 使用方法

### 方法 1: 点击按钮
1. 查看 ActivityBar（最左侧的窄条）
2. 点击顶部的切换按钮
3. 侧边栏会滑入或滑出

### 方法 2: 快捷键
1. 按 `Ctrl+B` (Mac: `Cmd+B`)
2. 侧边栏立即切换

### 方法 3: 自定义事件（开发者）
```typescript
// 触发切换
window.dispatchEvent(new Event('toggle-sidebar'));
```

## 📐 界面布局

### 隐藏侧边栏时
```
┌─────┬──────────────────────────────┐
│     │                              │
│  A  │                              │
│  c  │      主内容区域              │
│  t  │      (更宽敞的写作空间)      │
│  i  │                              │
│  v  │                              │
│  i  │                              │
│  t  │                              │
│  y  │                              │
│     │                              │
│  B  │                              │
│  a  │                              │
│  r  │                              │
│     │                              │
└─────┴──────────────────────────────┘
```

### 显示侧边栏时
```
┌─────┬──────────┬───────────────────┐
│     │          │                   │
│  A  │  书库    │                   │
│  c  │  侧边栏  │   主内容区域      │
│  t  │          │                   │
│  i  │  - 书1   │                   │
│  v  │  - 书2   │                   │
│  i  │  - 书3   │                   │
│  t  │          │                   │
│  y  │  [新建]  │                   │
│     │          │                   │
│  B  │  [操作]  │                   │
│  a  │          │                   │
│  r  │          │                   │
│     │          │                   │
└─────┴──────────┴───────────────────┘
```

## 🔧 技术实现

### 状态管理
```typescript
// 从 localStorage 读取初始状态
const [sidebarOpen, setSidebarOpen] = useState(() => {
  const saved = localStorage.getItem("sidebar-open");
  return saved ? saved === "true" : false; // 默认关闭
});

// 保存状态到 localStorage
useEffect(() => {
  localStorage.setItem("sidebar-open", String(sidebarOpen));
}, [sidebarOpen]);
```

### 快捷键处理
```typescript
// Ctrl/Cmd + B 切换侧边栏
if ((e.ctrlKey || e.metaKey) && e.key === "b") {
  e.preventDefault();
  setSidebarOpen((prev) => !prev);
}
```

### 组件通信
```typescript
// 根组件传递切换函数给 ActivityBar
<ActivityBar onToggleSidebar={() => setSidebarOpen((prev) => !prev)} />

// ActivityBar 使用 useSidebar hook 获取状态
const { open: sidebarOpen } = useSidebar();
```

## 💡 使用场景

### 场景 1: 专注写作
```
1. 打开一本书籍
2. 按 Ctrl+B 隐藏书库侧边栏
3. 享受更宽敞的写作空间
4. 需要切换书籍时，再按 Ctrl+B 显示
```

### 场景 2: 浏览书库
```
1. 在首页浏览所有书籍
2. 侧边栏显示所有书籍列表
3. 快速切换和管理书籍
```

### 场景 3: 小屏幕设备
```
1. 在笔记本电脑上使用
2. 默认隐藏侧边栏节省空间
3. 需要时快速显示
```

## 🎨 UI/UX 设计

### 动画效果
- 使用 CSS transition 实现平滑滑动
- 过渡时间：300ms
- 缓动函数：ease-in-out

### 图标设计
- **PanelLeftClose**: 表示"关闭左侧面板"（当前显示状态）
- **PanelLeftOpen**: 表示"打开左侧面板"（当前隐藏状态）
- 图标大小：20x20px
- 颜色：跟随主题

### 提示文字
- 显示状态："隐藏书库 (Ctrl+B)"
- 隐藏状态："显示书库 (Ctrl+B)"
- 位置：右侧弹出

## 📊 默认行为

### 首次使用
- 侧边栏默认**关闭**
- 给用户更多空间
- 用户可以根据需要打开

### 后续使用
- 记住用户上次的选择
- 保持一致的体验

## 🔄 与其他功能的配合

### 与底部抽屉
- 底部抽屉独立控制
- 可以同时隐藏侧边栏和底部抽屉
- 获得最大的写作空间

### 与全屏模式
- 配合全屏模式使用
- 提供完全沉浸的写作体验

### 与命令面板
- 可以通过命令面板切换
- 未来可以添加到命令列表

## 🚀 未来改进

### 短期计划
- [ ] 添加到命令面板
- [ ] 添加动画效果优化
- [ ] 支持拖拽调整宽度

### 长期计划
- [ ] 自动隐藏模式（鼠标移开自动隐藏）
- [ ] 迷你模式（只显示图标）
- [ ] 多种布局预设

## 📝 更新日志

### v0.1.1 - 2024-12-02
- ✨ 新增侧边栏切换功能
- ⌨️ 添加 Ctrl+B 快捷键
- 💾 自动保存用户偏好
- 🎨 优化切换按钮设计
- 📖 默认状态改为关闭

## 🙏 用户反馈

如果你有任何建议或问题，欢迎反馈：
- 是否需要调整默认状态？
- 动画速度是否合适？
- 是否需要更多的布局选项？

---

**提示**: 这个功能旨在提供更灵活的工作空间，让你可以根据当前任务调整界面布局。
