# Grain å‡½æ•°å¼æ•°æ®æµæ¶æ„

æœ¬æ–‡æ¡£å®šä¹‰ Grain é¡¹ç›®çš„æ ¸å¿ƒæ¶æ„è®¾è®¡ï¼ŒåŸºäºå‡½æ•°å¼ç¼–ç¨‹ç†å¿µï¼Œå®ç°æ•°æ®çš„å•å‘æµåŠ¨ã€‚

## è®¾è®¡å“²å­¦

```
å¯¹è±¡ = çº¯æ•°æ®ï¼ˆInterface + Builder æ„å»ºï¼‰
æ“ä½œ = çº¯å‡½æ•°ï¼ˆå¯¹æ•°æ®è¿›è¡Œå˜æ¢ï¼‰
æµåŠ¨ = ç®¡é“ï¼ˆpipe è¿æ¥å‡½æ•°ï¼‰
è¾¹ç•Œ = å…¥å£çª„ï¼Œå‡ºå£å®½
```

- **æ•°æ®æ˜¯æ°´æµ**ï¼šæ•°æ®åƒæ°´ä¸€æ ·æµç»ç®¡é“ï¼Œæ¯ä¸ªç®¡é“èŠ‚ç‚¹æ˜¯ä¸€ä¸ªçº¯å‡½æ•°
- **å¯¹è±¡æ— æ–¹æ³•**ï¼šInterface å’Œ Builder åªå®šä¹‰æ•°æ®ç»“æ„ï¼Œä¸åŒ…å«è¡Œä¸º
- **å‡½æ•°æ˜¯ç®¡é“**ï¼šæ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¯å‡½æ•°ï¼Œé€šè¿‡ pipe ç»„åˆ
- **ä¸å¯å˜æ€§**ï¼šæ•°æ®ä¸€æ—¦åˆ›å»ºå°±ä¸å¯ä¿®æ”¹ï¼Œæ›´æ–°äº§ç”Ÿæ–°å¯¹è±¡
- **å…¥å£çª„å‡ºå£å®½**ï¼šä¸¥æ ¼æ ¡éªŒè¾“å…¥ï¼ˆZod/serdeï¼‰ï¼Œå®½æ¾å¤„ç†è¾“å‡ºï¼ˆå®¹é”™ã€é™çº§ï¼‰

### å…¥å£çª„å‡ºå£å®½åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å…¥å£çª„å‡ºå£å®½                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚    å¤–éƒ¨æ•°æ®                                                      â”‚
â”‚        â”‚                                                        â”‚
â”‚        â–¼                                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚           ğŸšª çª„å…¥å£ï¼ˆä¸¥æ ¼æ ¡éªŒï¼‰          â”‚                   â”‚
â”‚    â”‚                                       â”‚                   â”‚
â”‚    â”‚  - Zod Schema ä¸¥æ ¼æ ¡éªŒ                â”‚                   â”‚
â”‚    â”‚  - serde ååºåˆ—åŒ– + è‡ªå®šä¹‰æ ¡éªŒ         â”‚                   â”‚
â”‚    â”‚  - æ‹’ç»ä¸ç¬¦åˆè§„èŒƒçš„æ•°æ®                â”‚                   â”‚
â”‚    â”‚  - æ—©å¤±è´¥ï¼Œå¿«å¤±è´¥                      â”‚                   â”‚
â”‚    â”‚  - æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯                      â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â”‚                                        â”‚
â”‚                        â–¼                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚           ğŸ­ çº¯å‡½æ•°å¤„ç†æ ¸å¿ƒ             â”‚                   â”‚
â”‚    â”‚                                       â”‚                   â”‚
â”‚    â”‚  - ç±»å‹å®‰å…¨çš„æ•°æ®æµ                    â”‚                   â”‚
â”‚    â”‚  - ä¸å¯å˜æ•°æ®è½¬æ¢                      â”‚                   â”‚
â”‚    â”‚  - å¯é¢„æµ‹çš„è¡Œä¸º                        â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â”‚                                        â”‚
â”‚                        â–¼                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    â”‚           ğŸš€ å®½å‡ºå£ï¼ˆå®¹é”™è¾“å‡ºï¼‰          â”‚                   â”‚
â”‚    â”‚                                       â”‚                   â”‚
â”‚    â”‚  - ä¼˜é›…é™çº§ï¼ˆç¼ºå¤±å­—æ®µç”¨é»˜è®¤å€¼ï¼‰         â”‚                   â”‚
â”‚    â”‚  - å…¼å®¹å¤šç§å®¢æˆ·ç«¯ç‰ˆæœ¬                  â”‚                   â”‚
â”‚    â”‚  - å¯é€‰å­—æ®µçµæ´»å¤„ç†                    â”‚                   â”‚
â”‚    â”‚  - å‘åå…¼å®¹çš„å“åº”æ ¼å¼                  â”‚                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â”‚                                        â”‚
â”‚                        â–¼                                        â”‚
â”‚    å¤–éƒ¨æ¶ˆè´¹è€…                                                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…¥å£çª„ï¼ˆStrict Inputï¼‰**ï¼š
);

// 4. Repo è°ƒç”¨ Rust åç«¯
const create = (node) => TE.tryCatch(
  () => invoke("create_node", { node }),
  AppError.fromUnknown
);
```

## è®¾è®¡åŸåˆ™

1. **æ•°æ®å•å‘æµåŠ¨**ï¼šComponent â†’ Hook â†’ Action â†’ Repo â†’ Rust
2. **å‰¯ä½œç”¨è¾¹ç•Œ**ï¼šåªæœ‰ repo å±‚æœ‰ IO å‰¯ä½œç”¨
3. **çº¯å‡½æ•°ä¼˜å…ˆ**ï¼šfn å±‚æ˜¯çº¯å‡½æ•°ï¼Œæ— å‰¯ä½œç”¨
4. **é”™è¯¯å¤„ç†**ï¼šä½¿ç”¨ TaskEitherï¼Œä¸ç”¨ try-catch

## ä¾èµ–è§„åˆ™

| å±‚çº§ | å¯ä¾èµ– |
|------|--------|
| `components/` | `hooks/`, `types/` |
| `hooks/` | `actions/`, `stores/` |
| `actions/` | `fn/`, `repo/`, `types/` |
| `fn/` | `types/`, `lib/` |
| `repo/` | `types/`, `lib/` |

## ç¦æ­¢çš„æ¨¡å¼

```typescript
// âŒ Component ç›´æ¥è°ƒç”¨ repo
const handleClick = () => nodeRepo.create(data)();

// âŒ Hook ç›´æ¥è°ƒç”¨ repo
const useNodes = () => useQuery({
  queryFn: () => nodeRepo.getAll()(),  // åº”è¯¥é€šè¿‡ action
});

// âœ… æ­£ç¡®ï¼šComponent â†’ Hook â†’ Action â†’ Repo
const handleClick = () => mutate(data);
```
